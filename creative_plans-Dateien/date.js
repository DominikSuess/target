define(["underscore","utils","config"],function(e,t,r){var n={getDateFromObject:function(e){return e instanceof Date?e:"number"==typeof e?new Date(e):(new Date).setISO8601(e)},is12HourClock:function(){var e={en:!0,"en-us":!0,"en-au":!0,"en-ca":!0,"zh-tw":!0};return function(t){return e[t]||!1}}(),isMDY:function(){var e={en:!0,"en-us":!0,"en-ca":!0,"en-ph":!0};return function(t){return e[t]||!1}}(),isYMD:function(){var e={"fr-ca":!0,ja:!0,"ja-jp":!0,ko:!0,"ko-kr":!0,sv:!0,"sv-se":!0,"zh-tw":!0};return function(t){return e[t]||!1}}(),isToday:function(e){var t=(new Date-(new Date).setHours(0,0,0))/1e3,r=n.getDateFromObject(e),a=Math.round(((new Date).getTime()-r.getTime())/1e3);return t>a},getDateSeparator:function(){var e=".",t=". ",r="-",n="/",a={cs:e,"cs-cz":e,de:e,nb:e,no:e,ru:e,fi:e,tr:e,pl:e,ko:t,"ko-kr":t,sv:r,"sv-se":r,nl:r};return function(e){return a[e]||n}}(),getMonthYearSeparator:function(){var e=" ",t="년 ",r=" de ",n="年",a={pt:r,es:r,ja:n,"zh-tw":n,ko:t,"ko-kr":t};return function(t){return a[t]||e}}(),convertDiffUtToSeconds:function(e){var t=n.getDateFromObject(e),r=Math.round(((new Date).getTime()-t.getTime())/1e3);return r},formatDate:function(e){return e?n.formatCalendarDate(e)+" "+n.formatTime(e.getHours(),e.getMinutes(),r("locale")):""},formatDay:function(){var e={en:!0,"en-au":!0,"nl-be":!0,"fr-be":!0,"en-ca":!0,"es-co":!0,fi:!0,"es-gt":!0,"zh-hk":!0,ms:!0,"en-nz":!0,"es-pe":!0,"en-ph":!0,ko:!0,"ko-kr":!0,"zh-tw":!0,th:!0,tr:!0,"en-us":!0},t={"de-at":!0};return function(r,n,a){return r?e[a]?""+n.getDate():(n.getDate()<10?"0":"")+n.getDate():t[a]?(n.getDate()<10?"0":"")+n.getDate():""+n.getDate()}}(),formatMonthNumber:function(){var e={en:!0,"en-ca":!0,fi:!0,"zh-hk":!0,"en-ph":!0,ko:!0,"ko-kr":!0,"zh-tw":!0,th:!0,"en-us":!0};return function(t,r){return e[r]?""+(t.getMonth()+1):(t.getMonth()<9?"0":"")+(t.getMonth()+1)}}(),formatYear:function(){var e={fi:!0,ja:!0,sv:!0,"sv-se":!0,"zh-tw":!0,tr:!0};return function(t,r){return e[r]?""+t.getFullYear():t.getFullYear().toString().substr(2)}}(),formatCalendarDate:function(e){if(e){var t=r("locale"),a=n.formatDay(!0,e,t),o=n.formatMonthNumber(e,t),u=n.formatYear(e,t),c=n.getDateSeparator(t);return n.isYMD(t)?u+c+o+c+a+("ko"===t||"ko-kr"===t?".":""):n.isMDY(t)?o+c+a+c+u:a+c+o+c+u}return""},lowercaseFirstLetter:function(e){return e.charAt(0).toLowerCase()+e.slice(1)},formatMonthName:function(){var e={"es-ar":!0,"nl-be":!0,"fr-be":!0,"fr-ca":!0,"es-cl":!0,"es-co":!0,"es-cr":!0,cs:!0,"cs-cz":!0,da:!0,"da-dk":!0,"es-do":!0,"es-ec":!0,fi:!0,fr:!0,"fr-fr":!0,"es-gt":!0,it:!0,"fr-lu":!0,"es-mx":!0,nl:!0,nb:!0,no:!0,"es-pe":!0,pl:!0,pt:!0,es:!0,"es-es":!0,sv:!0,"sv-se":!0,"fr-ch":!0,"it-ch":!0,"es-ve":!0,ru:!0};return function(t,r){return e[r]?n.lowercaseFirstLetter(t):t}}(),formatMonthAndYear:function(e){var t=e.getMonth()+1,a=n.getMonthName(t),o=e.getFullYear(),u=r("locale");a=n.formatMonthName(a,u);var c=n.getMonthYearSeparator(u),i="ja"===u||"zh-tw"===u||"ko"===u||"ko-kr"===u;i&&(a=a.replace(/\s/g,""));var s=i?o:a,l=i?a:o,g=s+c+l;return g},getLongDateFormat:function(){var e={it:"Day Month Year",nl:"Day Month Year",pl:"Day Month Year",fr:"Day Month Year","fr-fr":"Day Month Year",tr:"Day Month Year",sv:"Day Month Year",ru:"Day Month Year",cs:"Day. Month Year","cs-cz":"Day. Month. Year",da:"Day. Month Year","da-dk":"Day. Month Year",de:"Day. Month Year",nb:"Day. Month Year",no:"Day. Month Year",fi:"Day. Month Year",pt:"Day de Month de Year",es:"Day de Month de Year",ko:"Year년 Month월 Day일","ko-kr":"Year년 Month월 Day일",ja:"Year年Month月Day日","ja-jp":"Year年Month月Day日",zh:"Year年Month月Day日","zh-tw":"Year年Month月Day日"};return function(t,r,n,a){return"Day Month Year"===e[t]?r+" "+n+" "+a+("ru"===t?" г.":""):"Day. Month Year"===e[t]?(("da"===t||"da-dk"===t)&&(n=n.substring(0,3)+"."),r+". "+n+("fi"===t?"ta":"")+" "+a):"Day de Month de Year"===e[t]?r+" de "+n+" de "+a:"Year년 Month월 Day일"===e[t]?a+"년 "+n+" "+r+"일":"Year年Month月Day日"===e[t]?(n=n.replace(/\s/g,""),a+"年"+n+r+"日"):n+" "+r+", "+a}}(),formatMonthDateAndYear:function(e){if(e){var t=r("locale"),a=n.formatDay(!1,e,t);if(CCweb.util.hasFeature("ccm_bug_fix")){var o;return"cs"===t||"cs-cz"===t||"pl"===t||"ru"===t?o=n.getGenitiveMonthName(e.getMonth()+1):(o=n.getMonthName(e.getMonth()+1),o=n.formatMonthName(o,t)),n.getLongDateFormat(t,a,o,e.getFullYear())}var u=n.getMonthName(e.getMonth()+1);u=n.formatMonthName(u,t);var c=e.getFullYear();return n.getLongDateFormat(t,a,u,c)}return""},formatTime:function(e,t,r){var a=n.is12HourClock(r),o=e,u=10>t?"0"+t:t,c="",i="";if(a){var s=e>12?e-12:0===e?12:e;"zh-tw"===r?(o=10>s?"0"+s:s,c=e>11?"下午 ":"上午 "):(o=s,i=e>11?"PM":"AM")}var l=c+o+":"+u+i;return l},getMonthName:function(e){switch(e){case 1:return t.loc("January");case 2:return t.loc("February");case 3:return t.loc("March");case 4:return t.loc("April");case 5:return t.loc("May");case 6:return t.loc("June");case 7:return t.loc("July");case 8:return t.loc("August");case 9:return t.loc("September");case 10:return t.loc("October");case 11:return t.loc("November");case 12:return t.loc("December")}return""},getGenitiveMonthName:function(e){switch(e){case 1:return t.loc("January-genitive").replace("-genitive","");case 2:return t.loc("February-genitive").replace("-genitive","");case 3:return t.loc("March-genitive").replace("-genitive","");case 4:return t.loc("April-genitive").replace("-genitive","");case 5:return t.loc("May-genitive").replace("-genitive","");case 6:return t.loc("June-genitive").replace("-genitive","");case 7:return t.loc("July-genitive").replace("-genitive","");case 8:return t.loc("August-genitive").replace("-genitive","");case 9:return t.loc("September-genitive").replace("-genitive","");case 10:return t.loc("October-genitive").replace("-genitive","");case 11:return t.loc("November-genitive").replace("-genitive","");case 12:return t.loc("December-genitive").replace("-genitive","")}return""},dateTimeAgoText:function(e){var a=n.getDateFromObject(e),o=new Date,u=a.getTime(),c=o.getTime(),i=c-u,s="",l=0,g=Math.floor(i/1e3),h=(new Date-(new Date).setHours(0,0,0))/1e3;if(25>g)return t.loc("just now");if(3600>g)l=Math.max(1,Math.floor(g/60)),s=1===l?t.loc("{0} minute ago",l):t.loc("{0} minutes ago",l);else{if(!(h>g)){var f=a.getHours(),D=a.getMinutes(),M=r("locale"),v=n.formatTime(f,D,M);return t.loc("at {0}",v)}l=Math.floor(g/3600),s=1===l?t.loc("{0} hour ago",l):t.loc("{0} hours ago",l)}return s},calculateDaysSinceDate:function(e){if(!e)return 0;var t=new Date,r=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()),n=Date.UTC(t.getFullYear(),t.getMonth(),t.getDate()),a=(n-r)/1e3;return Math.floor(a/86400)},calculateDaysUntilDate:function(e){if(!e)return 0;var t=new Date,r=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()),n=Date.UTC(t.getFullYear(),t.getMonth(),t.getDate()),a=(r-n)/1e3;return Math.ceil(a/86400)},calculateMonthsUntilDate:function(e){if(!e)return 0;var t=new Date,r=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()),n=Date.UTC(t.getFullYear(),t.getMonth(),t.getDate()),a=(r-n)/1e3;return Math.floor(a/2629800)},calculateYearsUntilDate:function(e){if(!e)return 0;var t=new Date,r=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()),n=Date.UTC(t.getFullYear(),t.getMonth(),t.getDate()),a=(r-n)/1e3;return Math.floor(a/31557600)}};return function(){var e=new RegExp("([0-9]{4})(-([0-9]{2})(-([0-9]{2})(T([0-9]{2}):([0-9]{2})(:([0-9]{2})(\\.([0-9]+))?)?(Z|(([-+])([0-9]{2}):?([0-9]{2})))?)?)?)?");Date.prototype.setISO8601=function(t){if(!t)return this;var r=t.match(e),n=0,a=new Date(r[1],0,1);return r[3]&&a.setMonth(r[3]-1),r[5]&&a.setDate(r[5]),r[7]&&a.setHours(r[7]),r[8]&&a.setMinutes(r[8]),r[10]&&a.setSeconds(r[10]),r[12]&&a.setMilliseconds(1e3*Number("0."+r[12])),r[14]&&(n=60*Number(r[16])+Number(r[17]),n*="-"==r[15]?1:-1),n-=a.getTimezoneOffset(),this.setTime(Number(Number(a)+60*n*1e3)),this},Date.prototype.toISOString=Date.prototype.toISOString||function(){function e(e){return 10>e?"0"+e:e}return function(){return this.getUTCFullYear()+"-"+e(this.getUTCMonth()+1)+"-"+e(this.getUTCDate())+"T"+e(this.getUTCHours())+":"+e(this.getUTCMinutes())+":"+e(this.getUTCSeconds())+"."+(this.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}}()}(),e.extend(t,n),n});