CCweb.view_cart_item=Backbone.View.extend({className:"cart_item",events:{"change .product_quantity_selector select":"onProductQuantitySelect","keyup .product_quantity_input":"onProductQuantityInputKeyUp","blur .product_quantity_input":"onProductQuantityInputFocusOut","click .close":"onCloseButtonClick"},initialize:function(t){t=t||{},_.bindAll(this,"render"),this.cartModel=t.cartModel;var e=CCweb.util.getResourcePath(CCweb.util.supportsRetinaDisplay?"/resource/img/plans/close_icon-2x.png":"/resource/img/plans/close_icon.png");this.template=_.template('<div class="product_icon"><img src="'+CCweb.util.getIconPathForSingleAppProduct(this.model.get("productCode"))+'" /></div><div class="product_desc"><div class="product_name">'+this.model.get("localizedProductName")+'</div><div class="product_price year"><%= CCweb.util.loc("{0}/month per license", "<span class=\'price\'>...</span>") %></div><div class="product_price year_prepaid"><%= CCweb.util.loc("{0}/year per license", "<span class=\'price\'>...</span>") %></div><img class="close" src="'+e+'" /><div class="product_quantity_container"><div class="product_quantity_header">'+CCweb.util.loc("Licenses")+'</div><div class="select_container product_quantity_selector" style="display: inline-block;"><select class="select_box"><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10+</option></select></div><input type="text" class="product_quantity_input txt" maxlength="3" size="3" style="display: none;"/></div><div class="product_subtotal_details"><div class="product_subtotal year">'+CCweb.util.loc("{0} / mo",'<span class="price">...</span>')+'</div><div class="product_subtotal year_prepaid">'+CCweb.util.loc("{0} / yr",'<span class="price">...</span>')+'</div><div class="product_subtotal_tax_label" /></div></div>'),this.model.on("change:subtotal",this.onSubtotalChange,this),this.model.on("change:localizedProductName",this.onProductNameChange,this)},render:function(){return this.$el.empty().append(this.template()),this.delegateEvents(),this.showAppropriateQuantitySelector(),this.updateQuantitySelector(),this.updatePrices(),this},showAppropriateQuantitySelector:function(){var t=this.model.get("quantity");10>t?(this.$(".product_quantity_input").hide(),this.$(".product_quantity_selector").show()):(this.$(".product_quantity_selector").hide(),this.$(".product_quantity_input").show())},updateQuantitySelector:function(){var t=this.model.get("quantity");this.$(".product_quantity_input").val(t),10>t&&this.$(".product_quantity_selector select").val(t)},updatePrices:function(){this.$(".product_price").hide(),this.$(".product_subtotal").hide(),this.cartModel.isYearPrepaidServiceCommitment()?(this.$(".product_price.year_prepaid").show(),this.$(".product_subtotal.year_prepaid").show()):(this.$(".product_price.year").show(),this.$(".product_subtotal.year").show());var t="...";if(this.model.offer){var e=this.model.offer.getUnitPrice();e&&(t=this.model.offer.formatPrice(e.get("priceWithoutTax")))}var i=this.model.get("subtotal");this.$(".product_price .price").empty().append(t),this.$(".product_subtotal .price").empty().append(i);var o=CCweb.util.getGenericPlusTaxString(CCweb.models.currency.get("currency"));return o&&this.$(".product_subtotal_tax_label").html(o),!1},onSubtotalChange:function(){this.updatePrices()},onProductNameChange:function(){return this.$(".product_name").html(this.model.get("localizedProductName")),!1},onProductQuantitySelect:function(){var t=this.$(".product_quantity_selector select").val();return t&&(t=parseInt(t,10),this.model.set("quantity",t),10===t&&(this.$(".product_quantity_selector").hide(),this.$(".product_quantity_input").show(),this.$(".product_quantity_input").val(t).select()),this.updatePrices()),!1},onProductQuantityInput:function(t){var e=this.validateQuantityInput(parseInt(t,10));this.model.set("quantity",e),this.updateQuantitySelector(),this.updatePrices()},onProductQuantityInputKeyUp:function(){var t=this.$(".product_quantity_input").val();return t&&this.onProductQuantityInput(t),!1},onProductQuantityInputFocusOut:function(){var t=this.$(".product_quantity_input").val();return this.onProductQuantityInput(t),!1},validateQuantityInput:function(t){var e=this.cartModel.get("maxUnitsPerProduct");return isNaN(t)||0>=t?t=1:t>e&&(t=e),t},onCloseButtonClick:function(){return this.cartModel.removeItem(this.model.get("productCode")),!1},onClose:function(){this.model.off("change:subtotal",this.onSubtotalChange,this),this.model.off("change:localizedProductName",this.onProductNameChange,this)}});